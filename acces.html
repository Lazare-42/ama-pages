<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AMA — Matrice d'acces aux fichiers</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  background: #0a0a0f; color: #fff; padding: 20px;
  line-height: 1.5;
}
.container { max-width: 900px; margin: 0 auto; }

/* Header */
.header { text-align: center; margin-bottom: 28px; padding: 20px 0; }
.header h1 { font-size: 1.6rem; margin-bottom: 6px; }
.header p { color: #888; font-size: 0.8rem; }

/* Role legend */
.roles { display: flex; gap: 8px; flex-wrap: wrap; justify-content: center; margin-bottom: 24px; }
.role-btn {
  padding: 8px 16px; border-radius: 20px; border: 1px solid #2a2a3a;
  background: #12121a; cursor: pointer; font-size: 0.75rem;
  transition: all 0.2s; user-select: none; display: flex; align-items: center; gap: 6px;
}
.role-btn:hover { transform: translateY(-1px); }
.role-btn.active { border-color: var(--role-color); background: var(--role-bg); }
.role-btn .dot { width: 8px; height: 8px; border-radius: 50%; background: var(--role-color); }
.role-btn .count { opacity: 0.5; margin-left: 2px; }

.role-btn[data-role="public"] { --role-color: #22c55e; --role-bg: rgba(34,197,94,0.12); }
.role-btn[data-role="collab"] { --role-color: #38bdf8; --role-bg: rgba(56,189,248,0.12); }
.role-btn[data-role="gestion"] { --role-color: #f59e0b; --role-bg: rgba(245,158,11,0.12); }
.role-btn[data-role="manager"] { --role-color: #ec4899; --role-bg: rgba(236,72,153,0.12); }
.role-btn[data-role="owner"] { --role-color: #818cf8; --role-bg: rgba(129,140,248,0.12); }

/* Pyramid */
.pyramid { margin-bottom: 28px; }
.pyramid-level {
  display: flex; align-items: center; gap: 12px;
  padding: 10px 16px; border: 1px solid #2a2a3a; margin-bottom: -1px;
  background: #12121a; transition: all 0.2s;
}
.pyramid-level:first-child { border-radius: 10px 10px 0 0; }
.pyramid-level:last-child { border-radius: 0 0 10px 10px; }
.pyramid-level .p-dot { width: 10px; height: 10px; border-radius: 50%; flex-shrink: 0; }
.pyramid-level .p-name { font-size: 0.8rem; font-weight: 600; width: 140px; flex-shrink: 0; }
.pyramid-level .p-desc { font-size: 0.7rem; color: #888; flex: 1; }
.pyramid-level .p-count { font-size: 0.7rem; color: #666; flex-shrink: 0; }

.pyramid-level[data-level="owner"] .p-dot { background: #818cf8; }
.pyramid-level[data-level="manager"] .p-dot { background: #ec4899; }
.pyramid-level[data-level="gestion"] .p-dot { background: #f59e0b; }
.pyramid-level[data-level="collab"] .p-dot { background: #38bdf8; }
.pyramid-level[data-level="public"] .p-dot { background: #22c55e; }

/* Section */
.section { margin-bottom: 20px; }
.section-title {
  font-size: 0.65rem; text-transform: uppercase; letter-spacing: 0.1em;
  color: #666; margin-bottom: 8px; padding-left: 4px;
}

/* File grid */
.file-grid { display: flex; flex-direction: column; gap: 4px; }
.file-row {
  display: grid; grid-template-columns: 1fr auto; gap: 8px;
  align-items: center; padding: 8px 12px;
  border: 1px solid #1a1a2a; border-radius: 8px;
  background: #12121a; transition: all 0.3s;
  font-size: 0.8rem;
}
.file-row:hover { border-color: #2a2a3a; }
.file-row.dimmed { opacity: 0.15; transform: scale(0.98); }
.file-row.highlighted { border-color: var(--hl-color); background: var(--hl-bg); }

.file-info { display: flex; flex-direction: column; gap: 2px; min-width: 0; }
.file-name { font-weight: 500; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.file-path { font-size: 0.65rem; color: #555; font-family: monospace; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.file-url { font-size: 0.65rem; color: #444; font-family: monospace; }

.file-roles { display: flex; gap: 4px; flex-shrink: 0; }
.file-dot {
  width: 8px; height: 8px; border-radius: 50%; opacity: 0.25;
  transition: all 0.2s;
}
.file-dot.on { opacity: 1; }
.file-dot[data-r="public"] { background: #22c55e; }
.file-dot[data-r="collab"] { background: #38bdf8; }
.file-dot[data-r="gestion"] { background: #f59e0b; }
.file-dot[data-r="manager"] { background: #ec4899; }
.file-dot[data-r="owner"] { background: #818cf8; }

/* Stats bar */
.stats {
  display: grid; grid-template-columns: repeat(5, 1fr); gap: 6px;
  margin-bottom: 24px;
}
.stat {
  text-align: center; padding: 10px 8px;
  border: 1px solid #2a2a3a; border-radius: 8px; background: #12121a;
}
.stat .num { font-size: 1.2rem; font-weight: 700; }
.stat .label { font-size: 0.6rem; color: #888; text-transform: uppercase; letter-spacing: 0.05em; margin-top: 2px; }

/* Responsive */
@media (max-width: 600px) {
  .roles { gap: 6px; }
  .role-btn { padding: 6px 12px; font-size: 0.7rem; }
  .stats { grid-template-columns: repeat(3, 1fr); }
  .pyramid-level .p-desc { display: none; }
}
</style>
</head>
<body>
<div class="container">

<div class="header">
  <h1>Matrice d'acces — Fichiers AMA</h1>
  <p>40 fichiers partages &middot; 5 niveaux d'acces &middot; ama-workspace.com</p>
</div>

<!-- Pyramid -->
<div class="pyramid">
  <div class="pyramid-level" data-level="owner">
    <div class="p-dot"></div>
    <div class="p-name">Proprietaires</div>
    <div class="p-desc">Yann, Laz — Tout voir, tout decider. Bible, strategie, conciergerie, config interne.</div>
    <div class="p-count" id="count-owner"></div>
  </div>
  <div class="pyramid-level" data-level="manager">
    <div class="p-dot"></div>
    <div class="p-name">Managers</div>
    <div class="p-desc">Chefs de projet — Dashboard, roadmap, suivi, contacts, dossiers institutionnels.</div>
    <div class="p-count" id="count-manager"></div>
  </div>
  <div class="pyramid-level" data-level="gestion">
    <div class="p-dot"></div>
    <div class="p-name">Equipes gestion</div>
    <div class="p-desc">Equipes operationnelles — Projets detailles, sous-projets, checklist, questionnaire.</div>
    <div class="p-count" id="count-gestion"></div>
  </div>
  <div class="pyramid-level" data-level="collab">
    <div class="p-dot"></div>
    <div class="p-name">Collaborateurs</div>
    <div class="p-desc">Partenaires, freelances — Fiches infos, portfolios complets, dossiers publics.</div>
    <div class="p-count" id="count-collab"></div>
  </div>
  <div class="pyramid-level" data-level="public">
    <div class="p-dot"></div>
    <div class="p-name">Public</div>
    <div class="p-desc">Visiteurs anonymes — Landing pages, portfolio artiste, presentation generale.</div>
    <div class="p-count" id="count-public"></div>
  </div>
</div>

<!-- Role filter buttons -->
<div class="roles">
  <div class="role-btn active" data-role="all" onclick="filterRole('all')">
    <span>Tous</span><span class="count" id="btn-count-all"></span>
  </div>
  <div class="role-btn" data-role="public" onclick="filterRole('public')">
    <span class="dot"></span><span>Public</span><span class="count" id="btn-count-public"></span>
  </div>
  <div class="role-btn" data-role="collab" onclick="filterRole('collab')">
    <span class="dot"></span><span>Collaborateurs</span><span class="count" id="btn-count-collab"></span>
  </div>
  <div class="role-btn" data-role="gestion" onclick="filterRole('gestion')">
    <span class="dot"></span><span>Gestion</span><span class="count" id="btn-count-gestion"></span>
  </div>
  <div class="role-btn" data-role="manager" onclick="filterRole('manager')">
    <span class="dot"></span><span>Managers</span><span class="count" id="btn-count-manager"></span>
  </div>
  <div class="role-btn" data-role="owner" onclick="filterRole('owner')">
    <span class="dot"></span><span>Proprietaires</span><span class="count" id="btn-count-owner"></span>
  </div>
</div>

<!-- Stats -->
<div class="stats" id="stats"></div>

<!-- File lists rendered by JS -->
<div id="file-list"></div>

</div>

<script>
// Access levels: each higher level inherits lower levels
// public < collab < gestion < manager < owner
const LEVELS = ['public','collab','gestion','manager','owner'];

const FILES = [
  // --- Landing pages ---
  { cat: 'Landing pages', name: 'Landing FR', path: 'Site/index.html', url: '/', min: 'public' },
  { cat: 'Landing pages', name: 'Landing EN', path: 'Site/index-en.html', url: '/en', min: 'public' },

  // --- Portfolios ---
  { cat: 'Portfolios', name: 'Portfolio artiste FR', path: 'Portfolios/portfolio-ama.html', url: '/portfolio', min: 'public' },
  { cat: 'Portfolios', name: 'Portfolio artiste EN', path: 'Portfolios/portfolio-ama-en.html', url: '/portfolio/en', min: 'public' },
  { cat: 'Portfolios', name: 'Portfolio institutionnel FR', path: 'Portfolios/portfolio-ama-institutional.html', url: '/portfolio/institutional', min: 'collab' },
  { cat: 'Portfolios', name: 'Portfolio institutionnel EN', path: 'Portfolios/portfolio-ama-institutional-en.html', url: '/portfolio/institutional/en', min: 'collab' },

  // --- Fiches infos ---
  { cat: 'Fiches infos', name: 'Hub fiches infos', path: 'fiches-infos.html', url: '/fiches', min: 'collab' },
  { cat: 'Fiches infos', name: 'Fiche KLIMA', path: 'fiche-klima.html', url: '/fiches/klima', min: 'collab' },
  { cat: 'Fiches infos', name: 'Fiche Ashoka', path: 'fiche-ashoka.html', url: '/fiches/ashoka', min: 'collab' },
  { cat: 'Fiches infos', name: 'Fiche Autofabricantes', path: 'fiche-autofabricantes.html', url: '/fiches/autofabricantes', min: 'collab' },
  { cat: 'Fiches infos', name: 'Fiche B Lab / B Corp', path: 'fiche-blab.html', url: '/fiches/blab', min: 'collab' },
  { cat: 'Fiches infos', name: 'Fiche CEEBIOS', path: 'fiche-ceebios.html', url: '/fiches/ceebios', min: 'collab' },
  { cat: 'Fiches infos', name: 'Fiche China-Global South', path: 'fiche-china-global-south.html', url: '/fiches/china-global-south', min: 'collab' },
  { cat: 'Fiches infos', name: 'Fiche Cite Fertile', path: 'fiche-cite-fertile.html', url: '/fiches/cite-fertile', min: 'collab' },
  { cat: 'Fiches infos', name: 'Fiche Creapole', path: 'fiche-creapole.html', url: '/fiches/creapole', min: 'collab' },
  { cat: 'Fiches infos', name: 'Fiche EADA', path: 'fiche-eada.html', url: '/fiches/eada', min: 'collab' },
  { cat: 'Fiches infos', name: 'Fiche French Tech', path: 'fiche-french-tech.html', url: '/fiches/french-tech', min: 'collab' },
  { cat: 'Fiches infos', name: 'Fiche Global South World', path: 'fiche-global-south-world.html', url: '/fiches/global-south-world', min: 'collab' },
  { cat: 'Fiches infos', name: 'Fiche LISAA', path: 'fiche-lisaa.html', url: '/fiches/lisaa', min: 'collab' },
  { cat: 'Fiches infos', name: 'Fiche Reserve des Arts', path: 'fiche-reserve-arts.html', url: '/fiches/reserve-arts', min: 'collab' },
  { cat: 'Fiches infos', name: 'Fiche Rougerie', path: 'fiche-rougerie.html', url: '/fiches/rougerie', min: 'collab' },
  { cat: 'Fiches infos', name: 'Fiche Solent', path: 'fiche-solent.html', url: '/fiches/solent', min: 'collab' },
  { cat: 'Fiches infos', name: 'Fiche People\'s Map', path: 'fiche-peoples-map.html', url: '/fiches/peoples-map', min: 'collab' },
  { cat: 'Fiches infos', name: 'Fiche Deep Blue Foundation', path: 'Docs/FICHE-DEEP-BLUE.html', url: '/fiches/deep-blue', min: 'collab' },

  // --- Projets ---
  { cat: 'Projets', name: 'Projet PIN-LAB', path: 'projet-pin-lab.html', url: '/projets/pin-lab', min: 'gestion' },
  { cat: 'Projets', name: 'Projet FLOAT', path: 'projet-float.html', url: '/projets/float', min: 'gestion' },
  { cat: 'Projets', name: 'Projet HUBJAM', path: 'projet-hubjam.html', url: '/projets/hubjam', min: 'gestion' },
  { cat: 'Projets', name: 'Projet INDEX', path: 'projet-index.html', url: '/projets/index', min: 'gestion' },
  { cat: 'Projets', name: 'Projet METR H2O', path: 'projet-metr-h2o.html', url: '/projets/metr-h2o', min: 'gestion' },

  // --- Sous-projets PIN-LAB ---
  { cat: 'Sous-projets PIN-LAB', name: 'PIN-LAB / HS Setup', path: 'pinlab-hs-setup.html', url: '/projets/pin-lab/hs-setup', min: 'gestion' },
  { cat: 'Sous-projets PIN-LAB', name: 'PIN-LAB / HW Organizer', path: 'pinlab-hw-organizer.html', url: '/projets/pin-lab/hw-organizer', min: 'gestion' },
  { cat: 'Sous-projets PIN-LAB', name: 'PIN-LAB / MID', path: 'pinlab-mid.html', url: '/projets/pin-lab/mid', min: 'gestion' },
  { cat: 'Sous-projets PIN-LAB', name: 'PIN-LAB / Po_Russes', path: 'pinlab-po-russes.html', url: '/projets/pin-lab/po-russes', min: 'gestion' },

  // --- Dossiers & questionnaires ---
  { cat: 'Dossiers', name: 'Dossier KLIMA School', path: 'Portfolios/KLIMA-SCHOOL-DOSSIER.html', url: '/dossiers/klima', min: 'manager' },
  { cat: 'Dossiers', name: 'Checklist BRI 2.0', path: 'checklist-bri.html', url: '/checklist-bri', min: 'gestion' },
  { cat: 'Dossiers', name: 'Questionnaire AMA', path: 'Portfolios/questionnaire-ama.html', url: '/questionnaire', min: 'gestion' },

  // --- Dashboard & docs internes ---
  { cat: 'Outils internes', name: 'Dashboard AMA', path: 'dashboard.html', url: '/dashboard', min: 'manager' },
  { cat: 'Outils internes', name: 'Bible AMA (doc maitre)', path: 'AMA-PROJECT-BIBLE.html', url: '/bible', min: 'owner' },
  { cat: 'Outils internes', name: 'Conciergerie RPN', path: 'conciergerie.html', url: '/conciergerie', min: 'owner' },
  { cat: 'Outils internes', name: 'Strategie Claude', path: 'Docs/STRATEGIE-CLAUDE-AMA.html', url: '/strategie-claude', min: 'owner' },
];

function hasAccess(fileMin, role) {
  return LEVELS.indexOf(role) >= LEVELS.indexOf(fileMin);
}

function getColor(role) {
  const colors = { public:'#22c55e', collab:'#38bdf8', gestion:'#f59e0b', manager:'#ec4899', owner:'#818cf8' };
  return colors[role];
}

let currentFilter = 'all';

function filterRole(role) {
  currentFilter = role;
  document.querySelectorAll('.role-btn').forEach(b => {
    b.classList.toggle('active', b.dataset.role === role);
  });
  renderFiles();
}

function renderFiles() {
  const container = document.getElementById('file-list');
  let html = '';
  let currentCat = '';

  FILES.forEach(f => {
    if (f.cat !== currentCat) {
      currentCat = f.cat;
      html += `<div class="section"><div class="section-title">${currentCat}</div><div class="file-grid" id="grid-${currentCat.replace(/\s/g,'-')}">`;
    }

    const visible = currentFilter === 'all' || hasAccess(f.min, currentFilter);
    const dimClass = visible ? '' : ' dimmed';

    // Highlight color based on minimum access
    const hlColor = getColor(f.min);
    const hlStyle = visible && currentFilter !== 'all'
      ? `--hl-color:${hlColor}; --hl-bg:${hlColor}11;`
      : '';
    const hlClass = visible && currentFilter !== 'all' ? ' highlighted' : '';

    // Dots for each role
    let dots = '';
    LEVELS.forEach(lvl => {
      const on = hasAccess(f.min, lvl) ? ' on' : '';
      dots += `<div class="file-dot${on}" data-r="${lvl}"></div>`;
    });

    html += `<div class="file-row${dimClass}${hlClass}" style="${hlStyle}">
      <div class="file-info">
        <div class="file-name">${f.name}</div>
        <div class="file-path">${f.path}</div>
        <div class="file-url">ama-workspace.com${f.url}</div>
      </div>
      <div class="file-roles">${dots}</div>
    </div>`;

    // Check if next item is different category
    const idx = FILES.indexOf(f);
    if (idx === FILES.length - 1 || FILES[idx + 1].cat !== currentCat) {
      html += `</div></div>`;
    }
  });

  container.innerHTML = html;
}

function renderStats() {
  const counts = {};
  LEVELS.forEach(lvl => {
    counts[lvl] = FILES.filter(f => hasAccess(f.min, lvl)).length;
  });

  // Pyramid counts
  document.getElementById('count-owner').textContent = counts.owner + ' fichiers';
  document.getElementById('count-manager').textContent = counts.manager + ' fichiers';
  document.getElementById('count-gestion').textContent = counts.gestion + ' fichiers';
  document.getElementById('count-collab').textContent = counts.collab + ' fichiers';
  document.getElementById('count-public').textContent = counts.public + ' fichiers';

  // Button counts
  document.getElementById('btn-count-all').textContent = '(' + FILES.length + ')';
  document.getElementById('btn-count-public').textContent = '(' + counts.public + ')';
  document.getElementById('btn-count-collab').textContent = '(' + counts.collab + ')';
  document.getElementById('btn-count-gestion').textContent = '(' + counts.gestion + ')';
  document.getElementById('btn-count-manager').textContent = '(' + counts.manager + ')';
  document.getElementById('btn-count-owner').textContent = '(' + counts.owner + ')';

  // Stats bar
  const labels = { public:'Public', collab:'Collabs', gestion:'Gestion', manager:'Managers', owner:'Proprio.' };
  let statsHtml = '';
  LEVELS.forEach(lvl => {
    statsHtml += `<div class="stat">
      <div class="num" style="color:${getColor(lvl)}">${counts[lvl]}</div>
      <div class="label">${labels[lvl]}</div>
    </div>`;
  });
  document.getElementById('stats').innerHTML = statsHtml;
}

// Init
renderStats();
renderFiles();
</script>
</body>
</html>
